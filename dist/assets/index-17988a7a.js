var E=Object.defineProperty;var w=(e,t,n)=>t in e?E(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var i=(e,t,n)=>(w(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();class V{constructor(t){i(this,"dragStartTime");i(this,"animationStartTime",0);i(this,"animationStartOffset",0);i(this,"networkDelay");i(this,"maxOffset");i(this,"offset",0);this.dragStartTime=t.dragStartTime,this.networkDelay=t.networkDelay,this.maxOffset=t.targetOffset}startAnimating(t){this.animationStartTime=t,this.animationStartOffset=this.offset}committed(){return performance.now()-this.dragStartTime>=this.networkDelay}}function s(){throw new Error("missing element")}class R extends V{constructor(n){super(n);i(this,"stopRatioInput",document.getElementById("stopRatioInput")??s());i(this,"frictionRatioInput",document.getElementById("frictionRatioInput")??s());i(this,"frictionCoeffInput",document.getElementById("frictionCoeffInput")??s());i(this,"minVelocityInput",document.getElementById("minVelocityInput")??s());i(this,"maxVelocityInput",document.getElementById("maxVelocityInput")??s());i(this,"stopRatio",parseFloat(this.stopRatioInput.value));i(this,"frictionRatio",parseFloat(this.frictionRatioInput.value));i(this,"frictionCoeff",parseFloat(this.frictionCoeffInput.value));i(this,"minVelocity",parseFloat(this.minVelocityInput.value));i(this,"maxVelocity",parseFloat(this.maxVelocityInput.value));i(this,"velocity",this.maxVelocity);i(this,"stopRatioDisplay",document.getElementById("stopRatioDisplay")??s());i(this,"frictionRatioDisplay",document.getElementById("frictionRatioDisplay")??s());i(this,"frictionCoeffDisplay",document.getElementById("frictionCoeffDisplay")??s());i(this,"minVelocityDisplay",document.getElementById("minVelocityDisplay")??s());i(this,"maxVelocityDisplay",document.getElementById("maxVelocityDisplay")??s());console.log("NEW MODEL "+this.networkDelay),this.stopRatioInput.addEventListener("input",this.updateDisplays),this.frictionRatioInput.addEventListener("input",this.updateDisplays),this.frictionCoeffInput.addEventListener("input",this.updateDisplays),this.minVelocityInput.addEventListener("input",this.updateDisplays),this.maxVelocityInput.addEventListener("input",this.updateDisplays)}updateDisplays(){this.stopRatioDisplay.innerHTML=this.stopRatioInput.value,this.frictionRatioDisplay.innerHTML=this.frictionRatioInput.value,this.frictionCoeffDisplay.innerHTML=this.frictionCoeffInput.value,this.minVelocityDisplay.innerHTML=this.minVelocityInput.value,this.maxVelocityDisplay.innerHTML=this.maxVelocityInput.value}advance(){let n=this.maxOffset;this.offset+=this.velocity;let a=!1;return this.committed()?this.velocity<this.minVelocity?this.velocity=this.minVelocity:this.offset>=n?(this.offset=n,a=!0):this.velocity<this.maxVelocity&&(this.velocity=this.velocity/(1-this.frictionCoeff),this.velocity>=this.maxVelocity&&(this.velocity=this.maxVelocity)):this.offset>=n*this.stopRatio?(this.offset=n*this.stopRatio,this.velocity=0):this.offset>n*this.frictionRatio&&(this.velocity=this.velocity*(1-this.frictionCoeff),this.velocity<this.minVelocity&&(this.velocity=this.minVelocity)),{done:a,offset:this.offset}}pointerMove(n){return this.offset+=n,this.offset<0&&(this.offset=0),this.offset}}let L=R,c,v,d=!1,f=!1;const I=document.getElementById("scrim")??s(),p=document.getElementById("networkDelayInput")??s(),g=Array.from(document.querySelectorAll('input[name="mode"]')).map(e=>e),x=document.getElementById("networkDelayDisplay")??s();function P(e){var t;((t=e.target)==null?void 0:t.id)!=""||d||(f=!0,l=h(),v=document.startViewTransition(),v.ready.then(()=>{c=document.documentElement.animate({},{duration:100,pseudoElement:"::view-transition-new(root)"}),c.pause(),I.style.display="block"}))}function B(e){if(!f)return;let t=l.pointerMove(e.movementX);document.documentElement.style.setProperty("--offset",`${t}px`);let a=.3+(1-t/document.documentElement.getBoundingClientRect().width)*.5;document.documentElement.style.setProperty("--scrim",`${a}`)}function O(e){f&&(f=!1,M().then(()=>{document.documentElement.animate([{"--scrim":0}],{duration:100}).finished.then(y)}))}let l=h();y();function D(e){const t=l.advance();console.log(t),document.documentElement.style.setProperty("--offset",`${t.offset}px`),t.done?e():requestAnimationFrame(()=>{D(e)})}function M(){return d=!0,l.startAnimating(performance.now()),new Promise(e=>{D(e)})}function y(){d=!1,document.documentElement.style.setProperty("--offset","0px"),document.documentElement.style.setProperty("--vertical-offset","0px"),document.documentElement.style.setProperty("--scrim","0.0"),c&&c.play(),I.style.display="none"}function h(){for(const e of g)e.checked;return new L({dragStartTime:performance.now(),networkDelay:parseFloat(p.value),targetOffset:document.documentElement.getBoundingClientRect().width})}function m(){x.innerHTML=p.value,l.updateDisplays(),l=h(),y()}function T(){p.addEventListener("input",m);for(const e of g)e.addEventListener("click",m);m(),window.addEventListener("pointerdown",P),window.addEventListener("pointerup",O),window.addEventListener("pointermove",B)}onload=T;
