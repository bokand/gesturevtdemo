var $=Object.defineProperty;var U=(n,t,e)=>t in n?$(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var a=(n,t,e)=>(U(n,typeof t!="symbol"?t+"":t,e),e),L=(n,t,e)=>{if(!t.has(n))throw TypeError("Cannot "+e)};var l=(n,t,e)=>(L(n,t,"read from private field"),e?e.call(n):t.get(n)),w=(n,t,e)=>{if(t.has(n))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(n):t.set(n,e)},v=(n,t,e,o)=>(L(n,t,"write to private field"),o?o.call(n,e):t.set(n,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function e(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(s){if(s.ep)return;s.ep=!0;const i=e(s);fetch(s.href,i)}})();class G{constructor(t){a(this,"animationStartTime",0);a(this,"animationStartOffset",0);a(this,"networkDelay");a(this,"maxOffset");a(this,"offset",0);a(this,"parallax");a(this,"limitFingerDrag");this.networkDelay=t.networkDelay,this.maxOffset=t.targetOffset,this.parallax=t.parallax,this.limitFingerDrag=t.limitFingerDrag}startAnimating(t){this.animationStartTime=t,this.animationStartOffset=this.offset}pointerUp(t){}committed(){return performance.now()-this.animationStartTime>=this.networkDelay}}function Y(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var B={exports:{}};(function(n){(function(){n.exports=t;function t(e,o,s,i){typeof s=="object"&&(i=s,s=!1),typeof i>"u"&&(i={});for(var r=0,c=0,y=0,d=0,f=e.length,u=0;u<f;++u)r+=e[u],c+=o[u],y+=e[u]*o[u],d+=e[u]*e[u];if(i.m=(y-r*c/f)/(d-r*r/f),i.b=c/f-i.m*r/f,s){for(var q=0,g=0;g<f;++g)q+=(o[g]-i.b-i.m*e[g])*(o[g]-i.b-i.m*e[g]);var M=f*d-r*r,b=1/(f-2)*q;i.bErr=Math.sqrt(b/M*d),i.mErr=Math.sqrt(f/M*b)}return function(C){return i.m*C+i.b}}})()})(B);var K=B.exports;const Z=Y(K);function O(){throw new Error("missing element")}function H(n){let t={m:0};const e=n.map(s=>s.offset),o=n.map(s=>s.time);return Z(o,e,!1,t),t.m,console.log(n),console.log(t),t.m}const I=10,z=10;class F{constructor(t){a(this,"mass",1);a(this,"initialVelocity",0);a(this,"dampingRatio");a(this,"undampedNaturalFrequency");a(this,"dampedNaturalFrequency");a(this,"lastNFrames");a(this,"name");const e=(2*Math.PI/t.frequencyResponse)**2*this.mass;this.undampedNaturalFrequency=Math.sqrt(e/this.mass),this.dampedNaturalFrequency=this.undampedNaturalFrequency*Math.sqrt(Math.abs(1-t.dampingRatio**2)),this.dampingRatio=t.dampingRatio,this.lastNFrames=[],this.name=t.name}position(t,e){console.log("Start position: "+t),console.log("Time: "+e);const o=this.undampedNaturalFrequency*this.dampingRatio,s=this.dampedNaturalFrequency,i=(this.initialVelocity+o*t)/s,r=t,c=Math.exp(-o*e)*(i*Math.sin(s*e)+r*Math.cos(s*e));if(isNaN(c)||!isFinite(c))throw"Spring config invalid. Position: "+c;this.lastNFrames.push({offset:c,time:e});let y=!1;if(this.lastNFrames.length>I){this.lastNFrames.shift();let d=0;for(let f of this.lastNFrames)d+=f.offset*f.offset;y=d<z*I}return{offset:c,done:y}}velocity(){return H(this.lastNFrames)}}var h,m,D;class J extends G{constructor(e){super(e);w(this,h,void 0);w(this,m,void 0);w(this,D,void 0);a(this,"lastRaf",null);a(this,"hasCommitted",!1);a(this,"pointerHistory",[]);this.animationStartOffset=this.animationStartTime,v(this,h,new F({frequencyResponse:200,dampingRatio:.95,name:"100%"})),v(this,m,new F({frequencyResponse:1600,dampingRatio:.8,name:"80%"})),v(this,D,new F({frequencyResponse:1e3,dampingRatio:.95,name:"0%"}))}updateDisplays(){}advance(e){e=e,!this.hasCommitted&&this.committed()&&(this.startAnimating(this.lastRaf||e),this.hasCommitted=!0,l(this,h).initialVelocity=l(this,m).velocity(),console.log("VELOCITY HANDOFF: "+l(this,m).velocity()));const o=e-this.animationStartTime;let s=null;return this.hasCommitted?(console.log(l(this,h)),s=l(this,h).position(this.maxOffset-this.animationStartOffset,o),this.offset=this.maxOffset-s.offset):(s=l(this,m).position(this.maxOffset*.8-this.animationStartOffset,o),console.log(l(this,m)),this.offset=this.maxOffset*.8-s.offset),console.log("Offset "+this.offset),this.lastRaf=e,{done:s.done&&this.hasCommitted,fgOffset:this.offset,bgOffset:this.fgToBgOffset(this.offset)}}pointerMove(e){return this.offset=this.fingerDragAdd(this.offset,e.movementX),this.pointerHistory.push({offset:this.offset,time:e.timeStamp}),this.pointerHistory.length>10&&this.pointerHistory.shift(),this.offset<0&&(this.offset=0),{done:!1,fgOffset:this.offset,bgOffset:this.fgToBgOffset(this.offset)}}fingerDragAdd(e,o){return this.limitFingerDrag?e+.8*o:e+o}fgToBgOffset(e){return this.parallax?.25*(e-this.maxOffset):0}pointerUp(e){l(this,m).initialVelocity=Math.max(-H(this.pointerHistory),-1.2),console.log("STARTING VELOCITY: "+l(this,m).initialVelocity)}}h=new WeakMap,m=new WeakMap,D=new WeakMap;let E,T,S=!1,P=!1;const k=document.getElementById("scrim")??O(),R=document.getElementById("networkDelayInput")??O(),Q=document.getElementById("networkDelayDisplay")??O(),W=document.getElementById("settingParallax")??O(),j=document.getElementById("settingLimitFingerDrag")??O();function X(){return"#"+Math.floor(Math.random()*16777215).toString(16)}function tt(n){var t;((t=n.target)==null?void 0:t.id)!=""||S||(P=!0,p=N(),T=document.startViewTransition(),T.ready.then(()=>{document.documentElement.style.setProperty("--main-background-color",X()),E=document.documentElement.animate({},{duration:0,pseudoElement:"::view-transition-new(root)"}),E.pause(),k.style.display="block"}))}function V(n){return .3+(1-n/document.documentElement.getBoundingClientRect().width)*.5}function et(n){if(!P)return;let t=p.pointerMove(n);document.documentElement.style.setProperty("--fg-offset",`${t.fgOffset}px`),document.documentElement.style.setProperty("--bg-offset",`${t.bgOffset}px`),document.documentElement.style.setProperty("--scrim",`${V(t.fgOffset)}`)}function nt(n){P&&(P=!1,p.pointerUp(n),st().then(()=>{document.documentElement.animate([{"--scrim":0}],{duration:100}).finished.then(x)}))}let p=N();x();function _(n,t){const e=p.advance(n);console.log(e),document.documentElement.style.setProperty("--fg-offset",`${e.fgOffset}px`),document.documentElement.style.setProperty("--bg-offset",`${e.bgOffset}px`),document.documentElement.style.setProperty("--scrim",`${V(e.fgOffset)}`),e.done?t():requestAnimationFrame(o=>{_(o,t)})}function st(){return S=!0,p.startAnimating(performance.now()),new Promise(n=>{_(performance.now(),n)})}function x(){S=!1,document.documentElement.style.setProperty("--fg-offset","0px"),document.documentElement.style.setProperty("--vertical-offset","0px"),document.documentElement.style.setProperty("--scrim","0.0"),E&&E.play(),k.style.display="none"}function N(){return new J({networkDelay:parseFloat(R.value),targetOffset:document.documentElement.getBoundingClientRect().width,parallax:!!W.checked,limitFingerDrag:!!j.checked})}function A(){Q.innerHTML=R.value,p.updateDisplays(),p=N(),x()}function it(){R.addEventListener("input",A),A(),window.addEventListener("pointerdown",tt),window.addEventListener("pointerup",nt),window.addEventListener("pointermove",et)}onload=it;
